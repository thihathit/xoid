/*! For license information please see 51f4abce.48f85bbb.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{72:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return u})),n.d(t,"rightToc",(function(){return i})),n.d(t,"default",(function(){return l}));var r=n(2),o=n(6),c=(n(92),n(91)),a={id:"using-context-correctly",title:"Using context correctly"},u={unversionedId:"recipes/using-context-correctly",id:"recipes/using-context-correctly",isDocsHomePage:!1,title:"Using context correctly",description:"Using React context for rarely-occuring changes such as theme providers, or internationalization is harmless. However, when context starts to be used for other things, it can affect performance badly.",source:"@site/../docs/recipes/using-context-correctly.md",slug:"/recipes/using-context-correctly",permalink:"/docs/recipes/using-context-correctly",editUrl:"https://github.com/onurkerimov/xoid/blob/master/website/../docs/recipes/using-context-correctly.md",version:"current",lastUpdatedAt:1643467229,sidebar:"docs",previous:{title:"useSetup",permalink:"/docs/api-react/usesetup"},next:{title:"Refactoring React classes",permalink:"/docs/recipes/refactoring-react-classes"}},i=[],s={rightToc:i};function l(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"Using React context for rarely-occuring changes such as theme providers, or internationalization is harmless. However, when context starts to be used for other things, it can affect performance badly. "),Object(c.b)("p",null,"A context provider causes its whole subtree to rerender. This can result in noticable slowdowns. Even Redux has used React Context in v6, then reverted it in v7 due to ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/reduxjs/react-redux/issues/1164"}),"some recurring complaints"),". This was also mentioned in ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://blog.isquaredsoftware.com/2018/11/react-redux-history-implementation/#v7-0"}),"The History and Implementation of React-Redux by Mark Erikson"),"."),Object(c.b)("p",null,"There's ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://medium.com/@mweststrate/how-to-safely-use-react-context-b7e343eff076"}),"a great article by Michel Weststrate")," on using Context efficiently. In summary, the article argues that ",Object(c.b)("strong",{parentName:"p"},'"we should not store state directly in our context. Instead, we should use context as a dependency injection system"'),". ",Object(c.b)("strong",{parentName:"p"},"xoid")," can be used to do exactly that."),Object(c.b)("p",null,"Let's say, we're going to share a state with the following interface: ",Object(c.b)("inlineCode",{parentName:"p"},"{alpha: number, beta: number}"),". Instead of feeding it directly as a context value, we can make it an atom. We can create that atom only once, inside a ",Object(c.b)("inlineCode",{parentName:"p"},"useSetup")," hook."),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js",metastring:'title="./App.tsx"',title:'"./App.tsx"'}),"import { create } from 'xoid'\nimport { useSetup } from '@xoid/react'\nimport { MyContext } from './MyContext'\nimport { ConsumerComponent } from './ConsumerComponent'\n\nexport const App = () => {\n\n  const contextValue = useSetup(() => create({ alpha: 3, beta: 5 }))\n\n  return (\n    <MyContext.Provider value={contextValue}>\n      <ConsumerComponent />\n    </MyContext.Provider>\n  )\n}\n")),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js",metastring:'title="./MyComponent.tsx"',title:'"./MyComponent.tsx"'}),"import { useContext } from 'react'\nimport { useAtom } from '@xoid/react'\nimport { MyContext } from './MyContext'\n\nexport const MyComponent = () => {\n  const atom = useContext(MyContext)\n  const { alpha, beta } = useAtom(atom)\n\n  return (\n    <div>\n      alpha: {state.alpha}, beta: {state.beta}\n      <button onClick={() => select(atom, 'alpha')(s => s + 1)}>increment alpha</button>\n    </div>\n  )\n}\n")),Object(c.b)("p",null,"Only the components that subscribe to the content of ",Object(c.b)("inlineCode",{parentName:"p"},"MyContext")," explicitly via ",Object(c.b)("inlineCode",{parentName:"p"},"useAtom")," will rerender. Also note that, any component now has the chance to subscribe to a subtree/leaf of the same context such that: ",Object(c.b)("inlineCode",{parentName:"p"},"useAtom(atom, 'alpha')"),". This can greatly improve performance when needed."))}l.isMDXComponent=!0},91:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m}));var r=n(0),o=n.n(r);function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=o.a.createContext({}),l=function(e){var t=o.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):u(u({},t),e)),n},f=function(e){var t=l(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},y=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,c=e.originalType,a=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),f=l(n),y=r,m=f["".concat(a,".").concat(y)]||f[y]||p[y]||c;return n?o.a.createElement(m,u(u({ref:t},s),{},{components:n})):o.a.createElement(m,u({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var c=n.length,a=new Array(c);a[0]=y;var u={};for(var i in t)hasOwnProperty.call(t,i)&&(u[i]=t[i]);u.originalType=e,u.mdxType="string"==typeof e?e:r,a[1]=u;for(var s=2;s<c;s++)a[s]=n[s];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,n)}y.displayName="MDXCreateElement"},92:function(e,t,n){"use strict";e.exports=n(93)},93:function(e,t,n){"use strict";var r=n(94),o="function"==typeof Symbol&&Symbol.for,c=o?Symbol.for("react.element"):60103,a=o?Symbol.for("react.portal"):60106,u=o?Symbol.for("react.fragment"):60107,i=o?Symbol.for("react.strict_mode"):60108,s=o?Symbol.for("react.profiler"):60114,l=o?Symbol.for("react.provider"):60109,f=o?Symbol.for("react.context"):60110,p=o?Symbol.for("react.forward_ref"):60112,y=o?Symbol.for("react.suspense"):60113,m=o?Symbol.for("react.memo"):60115,d=o?Symbol.for("react.lazy"):60116,b="function"==typeof Symbol&&Symbol.iterator;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function O(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||v}function x(){}function j(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||v}O.prototype.isReactComponent={},O.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,t,"setState")},O.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=O.prototype;var w=j.prototype=new x;w.constructor=j,r(w,O.prototype),w.isPureReactComponent=!0;var C={current:null},S=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,n){var r,o={},a=null,u=null;if(null!=t)for(r in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,r)&&!k.hasOwnProperty(r)&&(o[r]=t[r]);var i=arguments.length-2;if(1===i)o.children=n;else if(1<i){for(var s=Array(i),l=0;l<i;l++)s[l]=arguments[l+2];o.children=s}if(e&&e.defaultProps)for(r in i=e.defaultProps)void 0===o[r]&&(o[r]=i[r]);return{$$typeof:c,type:e,key:a,ref:u,props:o,_owner:C.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===c}var _=/\/+/g,R=[];function $(e,t,n,r){if(R.length){var o=R.pop();return o.result=e,o.keyPrefix=t,o.func=n,o.context=r,o.count=0,o}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function M(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>R.length&&R.push(e)}function N(e,t,n,r){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var u=!1;if(null===e)u=!0;else switch(o){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case c:case a:u=!0}}if(u)return n(r,e,""===t?"."+T(e,0):t),1;if(u=0,t=""===t?".":t+":",Array.isArray(e))for(var i=0;i<e.length;i++){var s=t+T(o=e[i],i);u+=N(o,s,n,r)}else if(null===e||"object"!=typeof e?s=null:s="function"==typeof(s=b&&e[b]||e["@@iterator"])?s:null,"function"==typeof s)for(e=s.call(e),i=0;!(o=e.next()).done;)u+=N(o=o.value,s=t+T(o,i++),n,r);else if("object"===o)throw n=""+e,Error(h(31,"[object Object]"===n?"object with keys {"+Object.keys(e).join(", ")+"}":n,""));return u}function A(e,t,n){return null==e?0:N(e,"",t,n)}function T(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function I(e,t){e.func.call(e.context,t,e.count++)}function U(e,t,n){var r=e.result,o=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?D(e,r,n,(function(e){return e})):null!=e&&(E(e)&&(e=function(e,t){return{$$typeof:c,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,o+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(_,"$&/")+"/")+n)),r.push(e))}function D(e,t,n,r,o){var c="";null!=n&&(c=(""+n).replace(_,"$&/")+"/"),A(e,U,t=$(t,c,r,o)),M(t)}var q={current:null};function L(){var e=q.current;if(null===e)throw Error(h(321));return e}var F={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:C,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return D(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;A(e,I,t=$(null,null,t,n)),M(t)},count:function(e){return A(e,(function(){return null}),null)},toArray:function(e){var t=[];return D(e,t,null,(function(e){return e})),t},only:function(e){if(!E(e))throw Error(h(143));return e}},t.Component=O,t.Fragment=u,t.Profiler=s,t.PureComponent=j,t.StrictMode=i,t.Suspense=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.cloneElement=function(e,t,n){if(null==e)throw Error(h(267,e));var o=r({},e.props),a=e.key,u=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(u=t.ref,i=C.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)S.call(t,l)&&!k.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==s?s[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){s=Array(l);for(var f=0;f<l;f++)s[f]=arguments[f+2];o.children=s}return{$$typeof:c,type:e.type,key:a,ref:u,props:o,_owner:i}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:f,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=P,t.createFactory=function(e){var t=P.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:p,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:m,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return L().useCallback(e,t)},t.useContext=function(e,t){return L().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return L().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return L().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return L().useLayoutEffect(e,t)},t.useMemo=function(e,t){return L().useMemo(e,t)},t.useReducer=function(e,t,n){return L().useReducer(e,t,n)},t.useRef=function(e){return L().useRef(e)},t.useState=function(e){return L().useState(e)},t.version="16.13.1"},94:function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(o){return!1}}()?Object.assign:function(e,t){for(var n,u,i=a(e),s=1;s<arguments.length;s++){for(var l in n=Object(arguments[s]))o.call(n,l)&&(i[l]=n[l]);if(r){u=r(n);for(var f=0;f<u.length;f++)c.call(n,u[f])&&(i[u[f]]=n[u[f]])}}return i}}}]);